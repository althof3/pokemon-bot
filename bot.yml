id: 159216ac-65a2-413b-96de-fa3f65ce8291
revision: 10f32e79ac73c636047690cb7c7d866d24343f7b
name: pokebot_altop_2
tag: latest
deleted_at: null
desc: ""
timezone: 7
flows:
    default:
        active: true
        fallback: true
        intents:
            defaultIntent:
                type: text
                initial: false
                fallback: true
        states:
            init:
                transitions:
                    init:
                        fallback: true
                action: sayDontUnderstand
                initial: true
                end: true
        actions:
            sayDontUnderstand:
                type: text
                options:
                    text: 'Maaf saya belum mengerti :('
        methods: {}
    pokebot:
        active: true
        volatile: true
        intents:
            startIntent:
                type: text
                initial: true
                fallback: false
                condition: 'content == "/start"'
            nameIntent:
                type: text
                initial: false
                fallback: false
                classifier:
                    nlu: supermodel
                    match: person
                    options:
                        labels: true
                attributes:
                    name:
                        nlu: supermodel
                        path: person
            yesIntent:
                type: text
                initial: false
                fallback: false
                classifier:
                    nlu: yesNLU
                    match: yes
            postResultIntent:
                type: command
                initial: true
                fallback: false
                condition: 'content == "postResult"'
            pokemonInfoIntent:
                type: text
                initial: false
                fallback: false
                classifier:
                    nlu: pokemonInfoNLU
                    match: pokemonInformation
            alphanumIntent:
                type: text
                initial: false
                fallback: false
                classifier:
                    nlu: pokemonIdNLU
                    match: ""
            getResultIntent:
                type: command
                initial: false
                fallback: false
                condition: 'content == "getResult"'
        states:
            init:
                transitions:
                    whatsyourname:
                        condition: 'intent == "startIntent"'
                initial: true
            whatsyourname:
                transitions:
                    yourname:
                        condition: 'intent == "nameIntent"'
                        mapping:
                            context.name: attributes.name
                action: whatsyourname
            yourname:
                transitions:
                    welcome:
                        condition: 'intent == "yesIntent"'
                        mapping:
                            payload.name: context.name
                action: yourname
                transit:
                    payload.name: context.name
            welcome:
                transitions:
                    whichPokemonState:
                        condition: 'intent == "pokemonInfoIntent"'
                action:
                    -
                        name: welcome
                    -
                        name: postname2
            whichPokemonState:
                transitions:
                    fetchPokemonDetailAPI:
                        condition: 'intent == "alphanumIntent"'
                        mapping:
                            context.pokemonId: content
                action: whichPokemon
                transit:
                    context.pokemonId: content
            fetchPokemonDetailAPI:
                transitions:
                    showDetailPokemon:
                        condition: 'intent == "getResultIntent"'
                        mapping:
                            context.poke_name1: payload.result.name
                action:
                    -
                        name: fetchGetPokemonAPI
                    -
                        name: getResult
            showDetailPokemon:
                transitions: {}
                action:
                    -
                        name: detailPokemon
                    -
                        name: showImage
                end: true
        actions:
            whatsyourname:
                type: text
                options:
                    text: 'Hello what''s your name?'
            yourname:
                type: text
                options:
                    text: 'so your name is $(context.name)?'
            welcome:
                type: text
                options:
                    text: "Welcome to PokeBot,  $(context.name)!\nYou can send \"Pokemon information\" to get information about a Pokemon"
            postRegisterNameAPI:
                type: asyncApi
                options:
                    uri: 'https://pokemon-bot-production-3667.up.railway.app/api/users/register'
                    method: POST
                    body:
                        -
                            key: name
                            value: $(context.name)
                    headers:
                        -
                            key: x-api-key
                            value: supersecret
                    command: postResult
                    isAsync: true
            postResult:
                type: text
                options:
                    text: 'nama: $(payload.data.name)'
            postname:
                type: api
                options:
                    uri: 'https://pokemon-bot-production-3667.up.railway.app/api/users/register'
                    method: POST
                    isAsync: false
                    resultPath: postResult
                    body:
                        name: $(payload.name)
                    headers:
                        x-api-key: supersecret
            postCommand:
                type: command
                options:
                    command: postResult
                    payload:
                        result: $(result)
            postname2:
                type: api
                options:
                    uri: 'https://pokemon-bot-production-3667.up.railway.app/api/users/register'
                    method: POST
                    isAsync: false
                    resultPath: postResult
                    body:
                        name: $(context.name)
                    headers:
                        x-api-key: supersecret
            whichPokemon:
                type: text
                options:
                    text: 'Which pokemon do you need the info for?'
            fetchGetPokemonAPI:
                type: api
                options:
                    uri: 'https://pokemon-bot-production-3667.up.railway.app/api/pokemon/$(context.pokemonId)'
                    method: GET
                    isAsync: false
                    resultPath: getResult
                    headers:
                        x-api-key: supersecret
            getResult:
                type: command
                options:
                    command: getResult
                    payload:
                        result: $(result)
            detailPokemon:
                type: text
                options:
                    text: '$(payload.result.getResult.name) is an <$(payload.result.getResult.types)> type Pokemon with $(payload.result.getResult.weight) weight and $(payload.result.getResult.height) height, here''s a picture of $(payload.result.getResult.name).'
            showImage:
                type: template
                options:
                    type: image
                    items:
                        originalContentUrl: $(payload.result.getResult.image)
                        previewImageUrl: $(payload.result.getResult.image)
                        caption: image
        methods: {}
nlus:
    supermodel:
        type: nl
        options:
            nluId: 'althof3:pokebot_altop_2'
            threshold: 0.8
            output: phrase
            entity: kata
            labels: false
    yesNLU:
        type: keyword
        options:
            keywords:
                yes:
                    - yes
                    - iya
                    - 'true'
                    - betul
    pokemonInfoNLU:
        type: keyword
        options:
            keywords:
                pokemonInformation:
                    - 'pokemon information'
                    - 'poke info'
                    - info
                    - pokemon
                    - information
    pokemonIdNLU:
        type: regex
        options:
            regex: '[A-Za-z0-9]'
methods: {}
config: {}
